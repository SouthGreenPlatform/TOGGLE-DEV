##############################################
# Block for bwa::bwaAln
##############################################

($fastq1,$fastq2) = undef;

##DEBUG print LOG "INFOS toolbox ReadDir: @$fileList\n";

my @fileList = @$fileList;
for (my $i=0; $i<=$#fileList; $i++)
{

    next if ($fileList[$i] !~ m/fastq|fastq\.gz$/);
    
    ##########################################
    # bwa::bwaAln
    ##########################################
    $softParameters = toolbox::extractHashSoft($optionRef,$stepName);                                    # recovery of specific parameters of bwa aln
    ($fileWithoutExtention,$readGroup) = pairing::extractName($fileList[$i]);                             # extract name of file without the extention
    my $saiFileOut = "$newDir"."/"."$fileWithoutExtention".".BWAALN.sai";                                # name for the output file of bwa aln
    bwa::bwaAln($refFastaFile,$fileList[$i],$saiFileOut,$softParameters);                                # find the SA coordinates of the current file
    (not defined($fastq1))?$fastq1= $$fileList[$i]:$fastq2=$$fileList[$i];
}


