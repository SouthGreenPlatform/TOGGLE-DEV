

##########################################
# Block for bwa::bwaSampe
##########################################
print LOG "INFOS: $0 : Start BWA sampe\n";
$newDir = toolbox::changeDirectoryArbo($initialDir,4);                                                      # change for the bwa direcotry
##DEBUG print LOG "CHANGE DIRECTORY TO $newDir\n";
my $listOfSai = toolbox::readDir($bwaDir);                                                                  # read it to recover files in it
my @listOfSai = @$listOfSai;
my $fileWithoutExtention = pairing::extractName($listOfSai[0]);                                             # extract name of file without the extention
my $samFileOut = "$newDir"."/"."$fileWithoutExtention".".BWASAMPE.sam";                                     # name for the output file of bwa sampe
$softParameters = toolbox::extractHashSoft($optionref,"BWA sampe");                                      # recovery of specific parameters of bwa sampe
bwa::bwaSampe($samFileOut,$refFastaFile,$listOfSai[0],$listOfSai[1],$repairingList[0],$repairingList[1],$fileWithoutExtention,$softParameters); # generate alignement in SAM format
